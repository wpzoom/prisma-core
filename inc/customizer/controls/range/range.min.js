!function(){"use strict";wp.customize.controlConstructor["sinatra-range"]=wp.customize.Control.extend({ready:function(){var n=this,t=n.setting.get();n.container.find(".sinatra-range-wrapper").rangeControl({id:n.params.id,unit:n.params.unit,value:t,responsive:n.params.responsive,change:function(){n.save()}})},save:function(){var n={},t=this.params.responsive;if(!1===t||void 0===t||0==t.length)n.value=parseFloat(this.container.find(".sinatra-range-input").val());else for(var i in t)n[i]=parseFloat(this.container.find(".control-responsive."+i+" .sinatra-range-input").val());this.container.find(".sinatra-control-unit").length&&(n.unit=this.container.find(".sinatra-control-unit input:checked").val()),this.setting.set(n)}}),function(n){var t;t={options:{id:!1,option:!1,responsive:!1,unit:!1,value:!1,change:!1},_create:function(){var n=this,t=n.element;n.unit=t.find(".sinatra-control-wrap").attr("data-unit"),n._addListeners(),"object"==typeof n.options.responsive&&n._initResponsiveControls(),!1!==n.options.unit&&n._initUnit()},_addListeners:function(){var t,i,a,e,o=this;o.element.change(function(t){n.isFunction(o.options.change)&&o.options.change.call(this,t)}),o.element.on("keyup input paste",".sinatra-range-input",function(){o._autocorrectSlider(n(this))}).on("focusout",function(){o._autocorrectSlider(n(this))}),o.element.on("click","input[type=range]",function(){t=n(this),i=t.parent().children(".sinatra-range-input"),e=t.val(),a!==e&&(a=e,i.val(e).change())}),o.element.on("mousedown","input[type=range]",function(){t=n(this),i=t.parent().children(".sinatra-range-input"),t.mousemove(function(){e=t.val(),a!==e&&(a=e,i.val(e).change())})}),o.element.on("mouseup","input[type=range]",function(){n(this).off("mousemove")}),o.element.on("click",".sinatra-reset-range",function(){var t;o.element.find(".sinatra-reset-range").each(function(i,a){t=n(a),o.unit=t.data("reset_unit"),t.closest(".sinatra-range-wrapper").find('.sinatra-control-unit input[type="radio"][value="'+t.data("reset_unit")+'"]').click(),t.siblings("input").val(t.data("reset_value"))}),o.element.change()}),o.element.on("click",".sinatra-control-unit input",function(){var t=n(this);o.element.find('.sinatra-control-wrap input[type="range"]').each(function(i,a){n(this).attr("min",t.data("min")),n(this).attr("max",t.data("max")),n(this).attr("step",t.data("step"))}),"px"!==t.val()||"rem"!==o.unit&&"em"!==o.unit?"rem"!==t.val()&&"em"!==t.val()||"px"!==o.unit||(o.element.find("input.sinatra-range-input").each(function(t,i){n(i).val(n(i).val()/16),o._autocorrectSlider(n(i))}),o.unit=t.val()):(o.element.find("input.sinatra-range-input").each(function(t,i){n(i).val(Math.floor(16*n(i).val())),o._autocorrectSlider(n(i))}),o.unit=t.val())})},_autocorrectSlider:function(n){var t=n.parent().find('input[type="range"]'),i=parseFloat(n.val()),a=parseFloat(n.attr("step")),e=parseFloat(n.attr("min")),o=parseFloat(n.attr("max"));isNaN(i)?t.change():(a>=1&&i%1!=0&&(i=Math.round(i),n.val(i),t.val(i).change()),i>o&&(n.val(o),t.val(o).change()),i<e&&(n.val(e),t.val(e).change()),t.val(i).change())},_initResponsiveControls:function(){var t=this,i=t.element;i.find(".sinatra-control-wrap");if(i.addClass("sinatra-control-responsive"),i.find(".customize-control-title").length){var a=n('<ul class="sinatra-responsive-switchers"></ul>');for(var e in t.options.responsive)a.append('<li class="'+e+'"><span class="preview-'+e+'" data-device="'+e+'"><span class="sinatra-tooltip small-tooltip">'+e+'</span><i class="'+t.options.responsive[e].icon+'"></i></span></li>');i.find(".customize-control-title").append(a)}},_initUnit:function(){var t=this,i=t.element.find(".sinatra-control-wrap"),a=wp.template("sinatra-control-unit"),e={unit:t.options.unit,id:t.options.id,option:t.options.option,selected:i.attr("data-unit")};"object"==typeof t.options.unit?(n(a(e)).insertBefore(i),void 0!==t.options.value.unit&&i.parent().find("#"+t.options.id+"-"+t.options.value.unit+"-unit").click()):"string"==typeof t.options.unit&&n('<span class="sinatra-range-unit">'+t.options.unit+"</span>").insertAfter(i.find(".sinatra-range-input")),i.parent().find(".sinatra-control-unit input:checked").click()}},n.widget("sinatra.rangeControl",t)}(jQuery)}(jQuery);