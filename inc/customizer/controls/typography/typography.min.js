!function(t){"use strict";wp.customize.controlConstructor["sinatra-typography"]=wp.customize.Control.extend({ready:function(){var n=this,e=n.setting.get(),i=n.container.find(".popup-content");n.container.find("#font-family-"+n.params.id).select2(),n.container.find("#font-subsets-"+n.params.id).select2(),n.update_font_subsets_field(e["font-family"]),n.container.on("change","#font-family-"+n.params.id,function(){n.update_font_weight_field(t(this).val()),n.update_font_subsets_field(t(this).val())}),n.container.on("change","[data-option]",function(){n.update_value()}),n.container.find(".sinatra-range-wrapper").each(function(){var i=t(this);i.rangeControl({id:n.params.id+"-"+i.data("option-id"),option:i.data("option-id"),unit:n.params.units[i.data("option-id")],value:e[i.data("options-id")],responsive:n.params.responsive,change:function(){n.update_value()}})}),n.container.on("select2:opening","#font-family-"+n.params.id,function(){n.populate_font_family_field(),n.container.off("select2:opening","#font-family-"+n.params.id)}),n.container.on("mousedown",'[data-option="font-weight"]',function(){n.update_font_weight_field(n.container.find("#font-family-"+n.params.id).val()),n.container.off("mousedown",'[data-option="font-weight"]')}),n.container.on("select2:opening","#font-subsets-"+n.params.id,function(){n.update_font_subsets_field(n.container.find("#font-family-"+n.params.id).val()),n.container.off("mousedown",'[data-option="font-subsets"]')}),n.container.find(".popup-link").on("click",function(){i.toggleClass("hidden"),t(this).toggleClass("active"),t(this).siblings(".reset-defaults").toggleClass("active"),t("body").on("click",a)}),n.container.find(".reset-defaults").on("click",function(){"font-family"in n.params.display&&(n.populate_font_family_field(),n.container.find("#font-family-"+n.params.id).val(n.params.default["font-family"]).trigger("change")),["font-weight","font-style","text-transform","text-decoration"].forEach(t=>{t in n.params.display&&n.container.find('[data-option="'+t+'"]').val(n.params.default[t]).trigger("change")}),["font-size","line-height","letter-spacing"].forEach(t=>{n.container.find('[data-option-id="'+t+'"]').find(".sinatra-reset-range").click()})});var a=function(e){t(e.target).closest(".select2-container").length||t(e.target).closest(".customize-save-button-wrapper").length||t(e.target).closest(".reset-defaults").length||n.container.has(t(e.target).closest(".popup-link")).length||n.container.has(t(e.target).closest(".popup-content")).length||i.hasClass("hidden")||(i.addClass("hidden"),n.container.find(".popup-link").removeClass("active"),n.container.find(".reset-defaults").removeClass("active"),t("body").off("click",a))}},update_value:function(){var n,e={};this.container.find("[data-option]").each(function(){n=t(this).data("option"),e[n]="font-size-unit"===n||"line-height-unit"===n||"letter-spacing-unit"===n?t(this).is(":checked")?t(this).val():e[n]:t(this).val()}),this.setting.set(e)},update_font_weight_field:function(n){var e=this,i="",a="",o=e.setting.get();if("inherit"===n&&(a=' selected="selected"'),i+='<option value="inherit"'+a+">"+e.params.l10n.inherit+"</option>","inherit"===n||"default"===n){t.each(["100","200","300","400","500","600","700","800","900"],function(t,n){a=n===o["font-weight"]?' selected="selected"':"",i+='<option value="'+n+'"'+a+">"+e.params.l10n.weights[n]+"</option>"})}else t.each(sinatra_typography_vars.fonts,function(s,f){void 0===f.fonts[n]||t.each(f.fonts[n].variants,function(t,n){a=n===o["font-weight"]?' selected="selected"':"",i+='<option value="'+n+'"'+a+">"+e.params.l10n.weights[n]+"</option>"})});e.container.find(".sinatra-typography-font-weight").find("select").html(i)},update_font_subsets_field:function(n){var e="",i="",a=this.setting.get(),o=this.container.find(".sinatra-typography-font-subsets");"default"!==n&&"inherit"!==n?(t.each(sinatra_typography_vars.fonts,function(s,f){if(void 0!==f.fonts[n])return"system_fonts"===s||"standard_fonts"===s?o.hide():o.show(),void t.each(f.fonts[n].subsets,function(t,n){i="",(a["font-subsets"]&&-1!==a["font-subsets"].indexOf(n)||"latin"===n)&&(i=' selected="selected"'),e+='<option value="'+n+'"'+i+">"+n+"</option>"})}),o.find("select").html(e)):o.hide()},populate_font_family_field:function(n){var e=this,i="",a="",o=e.setting.get();a="inherit"===o["font-family"]?' selected="selected"':"",i+='<option value="inherit"'+a+">"+e.params.l10n.inherit+"</option>",a="default"===o["font-family"]?' selected="selected"':"",i+='<option value="default"'+a+">"+e.params.l10n.default+"</option>",t.each(sinatra_typography_vars.fonts,function(n,e){i+='<optgroup label="'+e.name+'">',t.each(e.fonts,function(t,n){a=t===o["font-family"]?' selected="selected"':"",i+='<option value="'+t+'"'+a+">"+t+"</option>"}),i+="</optgroup>"}),e.container.find("#font-family-"+e.params.id).html(i)}})}(jQuery);